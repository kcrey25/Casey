(function(b){var a=function(c,e){var d=this;d.v={};d.status={};d.settings=b.extend(true,{policy:{length_min:0,length_max:0,required_upper:0,required_lower:0,required_digits:0,required_special:0},accepted:{uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",lowercase:"abcdefghijklmnopqrstuvwxyz",numbers:"0123456789",chars:"!@#$%^&*?_~"}},e);this.initialize=function(){b(c).bind("change blur keyup input paste",d.test);d.test();return};d.test=function(){d.score();d.status.ok=false;d.status.message="";if(b(c).size()==0){d.status.message="password_field_not_detected"}else{var f=d.variations();if(f.total==0){d.status.message="null_password"}else{str=b(c).val();d.status.len=str.length;var h="";for(var g in d.settings.accepted){h+=d.settings.accepted[g]}h=String(h).split("").join("|").replace(/\^/,"\\^").replace(/\*/,"\\*").replace(/\?/,"\\?");if(str.match(new RegExp("[^"+h+"]"))){d.status.message="unwanted_characters"}else{if(d.settings.policy.length_min>0&&f.total<d.settings.policy.length_min){d.status.message="too_short"}else{if(d.settings.policy.length_max>0&&f.total>d.settings.policy.length_max){d.status.message="too_long"}else{if(d.settings.policy.required_upper>0&&f.upper_count<d.settings.policy.required_upper){d.status.message="require_uppercase"}else{if(d.settings.policy.required_lower>0&&f.lower_count<d.settings.policy.required_lower){d.status.message="require_lowercase"}else{if(d.settings.policy.required_digits>0&&f.digits_count<d.settings.policy.required_digits){d.status.message="require_digits"}else{if(d.settings.policy.required_special>0&&f.spec_count<d.settings.policy.required_special){d.status.message="require_special_characters"}else{d.status.message="ok";d.status.ok=true}}}}}}}}}b(c).trigger("passtest");return d};d.variations=function(){if(b(c).size()==0){return 0}var f=b(c).val();var g={total:f.length,chars:/[a-zA-Z]/.test(f),chars_count:f.replace(/[^a-zA-Z]/g,"").length,digits:/\d/.test(f),digits_count:f.replace(/[^0-9]/g,"").length,lower:/[a-z]/.test(f),lower_count:f.replace(/[^a-z]/g,"").length,upper:/[A-Z]/.test(f),upper_count:f.replace(/[^A-Z]/g,"").length,spec:/\W/.test(f),spec_count:f.replace(/\d/g,"").replace(/[A-Za-z]/g,"").length};return g};d.score=function(){var g=d.variations();var f=0;if(g.total>0&&g.total<5){f+=5}else{if(g.total>=5&&g.total<8){f+=10}else{if(g.total>=8){f+=25}}}if(g.upper_count==0&&g.lower_count!=0){f+=10}else{if(g.upper_count!=0&&g.lower_count==0){f+=10}else{if(g.upper_count!=0&&g.lower_count!=0){f+=20}}}if(g.digits_count==1){f+=10}else{if(g.digits_count==2){f+=15}else{if(g.digits_count>=3){f+=20}}}if(g.spec_count==1){f+=10}else{if(g.spec_count==2){f+=20}else{if(g.spec_count>1){f+=25}}}if(g.digits_count!=0&&g.chars_count!=0){f+=2}if(g.digits_count!=0&&g.chars_count!=0&&g.spec_count!=0){f+=3}if(g.lower_count!=0&&g.upper_count!=0&&g.digits_count!=0&&g.spec_count!=0){f+=5}d.status.score=f;return}};b.fn.passtest=function(e){var c=this;var d={};if(!b(c).data("jquery_passtest")){d=new a(c,e);d.initialize();b(c).data("jquery_passtest",d)}else{d=b(c).data("jquery_passtest");if(e){d.settings=b.extend(true,d.settings,e);d.test()}}return d}}(jQuery));
